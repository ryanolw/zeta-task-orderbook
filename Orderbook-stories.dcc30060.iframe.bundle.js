"use strict";(self.webpackChunkzeta_task=self.webpackChunkzeta_task||[]).push([[691],{"./src/stories/Orderbook.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ApiUnavailable:function(){return ApiUnavailable},HappyPath:function(){return HappyPath},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return Orderbook_stories}});var _zeta,objectSpread2=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),regeneratorRuntime=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),slicedToArray=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),chunk_VHPIVGMD=__webpack_require__("./node_modules/.pnpm/@chakra-ui+hooks@2.2.0_react@18.2.0/node_modules/@chakra-ui/hooks/dist/chunk-VHPIVGMD.mjs"),dataAdapters={zeta:(_zeta=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(apiUrl){var result;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,fetch(apiUrl).then((function(res){return res.json()}));case 2:return result=_context.sent,_context.abrupt("return",result.orderbooks[0]);case 4:case"end":return _context.stop()}}),_callee)}))),function zeta(_x){return _zeta.apply(this,arguments)})},adapters=dataAdapters,chunk_6CSUKJP7=__webpack_require__("./node_modules/.pnpm/@chakra-ui+layout@2.2.0_@chakra-ui+system@2.5.8_react@18.2.0/node_modules/@chakra-ui/layout/dist/chunk-6CSUKJP7.mjs"),chunk_O7JH6DZT=__webpack_require__("./node_modules/.pnpm/@chakra-ui+layout@2.2.0_@chakra-ui+system@2.5.8_react@18.2.0/node_modules/@chakra-ui/layout/dist/chunk-O7JH6DZT.mjs"),chunk_P74GIWPW=__webpack_require__("./node_modules/.pnpm/@chakra-ui+layout@2.2.0_@chakra-ui+system@2.5.8_react@18.2.0/node_modules/@chakra-ui/layout/dist/chunk-P74GIWPW.mjs"),chunk_3V5HNFOM=__webpack_require__("./node_modules/.pnpm/@chakra-ui+layout@2.2.0_@chakra-ui+system@2.5.8_react@18.2.0/node_modules/@chakra-ui/layout/dist/chunk-3V5HNFOM.mjs"),COLUMN_WIDTHS=["50%","50%"],chunk_WKZT7ZXJ=__webpack_require__("./node_modules/.pnpm/@chakra-ui+layout@2.2.0_@chakra-ui+system@2.5.8_react@18.2.0/node_modules/@chakra-ui/layout/dist/chunk-WKZT7ZXJ.mjs"),chunk_5AOLTBA4=__webpack_require__("./node_modules/.pnpm/@chakra-ui+hooks@2.2.0_react@18.2.0/node_modules/@chakra-ui/hooks/dist/chunk-5AOLTBA4.mjs"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function OrderEntry(_ref){var colorScheme=_ref.colorScheme,order=_ref.order,_useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),shouldUpdate=_useState2[0],setShouldUpdate=_useState2[1],_useTransition=(0,react.useTransition)(),_useTransition2=(0,slicedToArray.Z)(_useTransition,2),startTransition=(_useTransition2[0],_useTransition2[1]);(0,chunk_5AOLTBA4.r)((function(){setShouldUpdate(!0),setTimeout((function(){startTransition((function(){setShouldUpdate(!1)}))}),transitionDelayMs)}),[order.size,order.price]);var transitionDelayMs=200;return(0,jsx_runtime.jsxs)(chunk_O7JH6DZT.U,{position:"relative",py:1,px:2,children:[(0,jsx_runtime.jsx)(chunk_6CSUKJP7.xu,{top:0,left:0,zIndex:-1,h:"100%",transition:shouldUpdate?"":"background-color ".concat(transitionDelayMs,"ms linear"),bgColor:"".concat(colorScheme,".").concat(shouldUpdate?"200":"100"),w:"".concat(order.cumulativeTotalPct,"%"),position:"absolute"}),(0,jsx_runtime.jsx)(chunk_P74GIWPW.x,{w:COLUMN_WIDTHS[0],color:"".concat(colorScheme,".600"),children:order.price.toFixed(3)}),(0,jsx_runtime.jsx)(chunk_P74GIWPW.x,{w:COLUMN_WIDTHS[1],children:order.size.toFixed(3)})]})}try{OrderEntry.displayName="OrderEntry",OrderEntry.__docgenInfo={description:"",displayName:"OrderEntry",props:{colorScheme:{defaultValue:null,description:"",name:"colorScheme",required:!0,type:{name:"string"}},order:{defaultValue:null,description:"",name:"order",required:!0,type:{name:"EnrichedOrderProp"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Orderbook/components/OrderEntry.tsx#OrderEntry"]={docgenInfo:OrderEntry.__docgenInfo,name:"OrderEntry",path:"src/components/Orderbook/components/OrderEntry.tsx#OrderEntry"})}catch(__react_docgen_typescript_loader_error){}function OrderGroup(_ref){var data=_ref.data,colorScheme=_ref.colorScheme,_ref$direction=_ref.direction,direction=void 0===_ref$direction?"up":_ref$direction,enrichedData=(0,react.useMemo)((function(){if(!data.length)return[];var cumulativeTotal=0,res=data.map((function(order){var orderTotal=order.price*order.size;return cumulativeTotal+=orderTotal,(0,objectSpread2.Z)((0,objectSpread2.Z)({},order),{},{orderTotal:orderTotal,cumulativeTotal:cumulativeTotal})})),finalTotal=res[res.length-1].cumulativeTotal;return res.map((function(order){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},order),{},{cumulativeTotalPct:order.cumulativeTotal/finalTotal*100})}))}),[data]),containerStyle=(0,react.useMemo)((function(){return{up:"column-reverse",down:"column"}[direction]}),[direction]);return(0,jsx_runtime.jsx)(chunk_WKZT7ZXJ.K,{direction:containerStyle,spacing:0,children:enrichedData.map((function(order,idx){return(0,jsx_runtime.jsx)(OrderEntry,{colorScheme:colorScheme,order:order},idx)}))})}try{OrderGroup.displayName="OrderGroup",OrderGroup.__docgenInfo={description:"",displayName:"OrderGroup",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"Order[]"}},colorScheme:{defaultValue:null,description:"",name:"colorScheme",required:!0,type:{name:"string"}},direction:{defaultValue:{value:"up"},description:"",name:"direction",required:!1,type:{name:"enum",value:[{value:'"up"'},{value:'"down"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Orderbook/components/OrderGroup.tsx#OrderGroup"]={docgenInfo:OrderGroup.__docgenInfo,name:"OrderGroup",path:"src/components/Orderbook/components/OrderGroup.tsx#OrderGroup"})}catch(__react_docgen_typescript_loader_error){}function OrderbookBase(_ref){var data=_ref.data,error=_ref.error,className=_ref.className,containerStyles=_ref.containerStyles;return(0,jsx_runtime.jsxs)(chunk_6CSUKJP7.xu,(0,objectSpread2.Z)((0,objectSpread2.Z)({h:"50ch",overflow:"auto",position:"relative",borderRadius:"md",className:className},containerStyles),{},{children:[(0,jsx_runtime.jsxs)(chunk_O7JH6DZT.U,{position:"sticky",top:0,zIndex:2,fontWeight:"semibold",color:"gray.600",px:2,py:1,bgColor:"gray.100",children:[(0,jsx_runtime.jsx)(chunk_P74GIWPW.x,{w:COLUMN_WIDTHS[0],children:"Price"}),(0,jsx_runtime.jsx)(chunk_P74GIWPW.x,{w:COLUMN_WIDTHS[1],children:"Size"})]}),error?(0,jsx_runtime.jsx)(chunk_3V5HNFOM.M,{bgColor:"gray.50",h:"100%",children:"An error occured when attempting to retrieve new data."}):data?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(OrderGroup,{data:data.asks,colorScheme:"green",direction:"up"}),(0,jsx_runtime.jsx)(OrderGroup,{data:data.bids,colorScheme:"red",direction:"down"})]}):(0,jsx_runtime.jsx)(chunk_3V5HNFOM.M,{h:"100%",children:"Loading..."})]}))}try{OrderbookBase.displayName="OrderbookBase",OrderbookBase.__docgenInfo={description:"",displayName:"OrderbookBase",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"{ bids: Order[]; asks: Order[]; } | null"}},error:{defaultValue:null,description:"",name:"error",required:!0,type:{name:"Error | null"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},containerStyles:{defaultValue:null,description:"",name:"containerStyles",required:!1,type:{name:"BoxProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Orderbook/components/OrderbookBase.tsx#OrderbookBase"]={docgenInfo:OrderbookBase.__docgenInfo,name:"OrderbookBase",path:"src/components/Orderbook/components/OrderbookBase.tsx#OrderbookBase"})}catch(__react_docgen_typescript_loader_error){}function Orderbook(_ref){var dataAdapter=_ref.dataAdapter,_ref$pollingIntervalM=_ref.pollingIntervalMs,pollingIntervalMs=void 0===_ref$pollingIntervalM?5e3:_ref$pollingIntervalM,className=_ref.className,containerStyles=_ref.containerStyles,_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),data=_useState2[0],setData=_useState2[1],_useState3=(0,react.useState)(null),_useState4=(0,slicedToArray.Z)(_useState3,2),error=_useState4[0],setError=_useState4[1],fetchOrderData=function(){var _ref2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(){var orderData;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,dataAdapter(adapters);case 3:orderData=_context.sent,setData(orderData),setError(null),_context.next=11;break;case 8:_context.prev=8,_context.t0=_context.catch(0),setError(_context.t0);case 11:case"end":return _context.stop()}}),_callee,null,[[0,8]])})));return function fetchOrderData(){return _ref2.apply(this,arguments)}}();return(0,react.useEffect)((function(){fetchOrderData()}),[]),(0,chunk_VHPIVGMD.Y)((function(){fetchOrderData()}),pollingIntervalMs),(0,jsx_runtime.jsx)(OrderbookBase,{data:data,error:error,className:className,containerStyles:containerStyles})}try{Orderbook.displayName="Orderbook",Orderbook.__docgenInfo={description:"",displayName:"Orderbook",props:{dataAdapter:{defaultValue:null,description:"(Required) A function that retrieves orderbook data when called. A map of whitelisted data adapters are passed into this function as the first argument for convenience.\n\nA custom data adapter implementation can also be used - this function should return an object that satisfies the `OrderBookData` type.\nExamples:\n```ts\n<Orderbook\n   dataAdapter={() => fetch('<datasource URL>').then(res => res.json())}\n   pollingIntervalMs={5000} />\n```\n\n```ts\n<Orderbook\n   dataAdapter={() => localStore.retrieveOrderData()}\n   pollingIntervalMs={5000} />\n```",name:"dataAdapter",required:!0,type:{name:"(whitelistedAdapters: DataAdapters) => OrderBookData | Promise<OrderBookData>"}},pollingIntervalMs:{defaultValue:{value:"5000"},description:"Interval (in milliseconds) to invoke `dataAdapter` for new data. Default: 5000",name:"pollingIntervalMs",required:!1,type:{name:"number"}},className:{defaultValue:null,description:"Optional CSS classname that will be passed to the Orderbook container element",name:"className",required:!1,type:{name:"string"}},containerStyles:{defaultValue:null,description:"Optional Chakra UI Box props that will be passed to the Orderbook container element",name:"containerStyles",required:!1,type:{name:"BoxProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Orderbook/Orderbook.tsx#Orderbook"]={docgenInfo:Orderbook.__docgenInfo,name:"Orderbook",path:"src/components/Orderbook/Orderbook.tsx#Orderbook"})}catch(__react_docgen_typescript_loader_error){}var _HappyPath$parameters,_HappyPath$parameters2,_HappyPath$parameters3,_ApiUnavailable$param,_ApiUnavailable$param2,_ApiUnavailable$param3,chunk_DGNA6VRZ=__webpack_require__("./node_modules/.pnpm/@chakra-ui+react@2.7.0_@emotion+react@11.11.1_@emotion+styled@11.11.0_@types+react@18.2.9_fra_23nypeymt3fauxf7xbyrn7bjdq/node_modules/@chakra-ui/react/dist/chunk-DGNA6VRZ.mjs"),chunk_AQYX3YP4=__webpack_require__("./node_modules/.pnpm/@chakra-ui+theme-utils@2.0.18/node_modules/@chakra-ui/theme-utils/dist/chunk-AQYX3YP4.mjs"),Orderbook_stories={title:"Orderbook",component:Orderbook,argTypes:{dataAdapter:{control:"select",options:["zeta"]}}},HappyPath={args:{pollingIntervalMs:5e3,dataAdapter:function dataAdapter(_ref){return(0,_ref.zeta)("https://dex-mainnet-webserver-ecs.zeta.markets/orderbooks/SOL?marketIndexes[]=137")}},decorators:[function(Story){return(0,jsx_runtime.jsx)(chunk_DGNA6VRZ.x,{theme:(0,chunk_AQYX3YP4.B1)({styles:{global:function global(){return{body:{fontSize:"sm"}}}}}),children:(0,jsx_runtime.jsx)(Story,{})})}]},ApiUnavailable={args:{pollingIntervalMs:5e3,dataAdapter:function dataAdapter(_ref2){return(0,_ref2.zeta)("https://foo.bar")}},decorators:[function(Story){return(0,jsx_runtime.jsx)(chunk_DGNA6VRZ.x,{children:(0,jsx_runtime.jsx)(Story,{})})}]};HappyPath.parameters=(0,objectSpread2.Z)((0,objectSpread2.Z)({},HappyPath.parameters),{},{docs:(0,objectSpread2.Z)((0,objectSpread2.Z)({},null===(_HappyPath$parameters=HappyPath.parameters)||void 0===_HappyPath$parameters?void 0:_HappyPath$parameters.docs),{},{source:(0,objectSpread2.Z)({originalSource:"{\n  args: {\n    pollingIntervalMs: 5000,\n    dataAdapter: ({\n      zeta\n    }) => zeta('https://dex-mainnet-webserver-ecs.zeta.markets/orderbooks/SOL?marketIndexes[]=137')\n  },\n  decorators: [Story => <ChakraProvider theme={extendTheme({\n    styles: {\n      global: () => {\n        return {\n          body: {\n            fontSize: 'sm'\n          }\n        };\n      }\n    }\n  })}>\n        <Story />\n      </ChakraProvider>]\n}"},null===(_HappyPath$parameters2=HappyPath.parameters)||void 0===_HappyPath$parameters2||null===(_HappyPath$parameters3=_HappyPath$parameters2.docs)||void 0===_HappyPath$parameters3?void 0:_HappyPath$parameters3.source)})}),ApiUnavailable.parameters=(0,objectSpread2.Z)((0,objectSpread2.Z)({},ApiUnavailable.parameters),{},{docs:(0,objectSpread2.Z)((0,objectSpread2.Z)({},null===(_ApiUnavailable$param=ApiUnavailable.parameters)||void 0===_ApiUnavailable$param?void 0:_ApiUnavailable$param.docs),{},{source:(0,objectSpread2.Z)({originalSource:"{\n  args: {\n    pollingIntervalMs: 5000,\n    dataAdapter: ({\n      zeta\n    }) => zeta('https://foo.bar')\n  },\n  decorators: [Story => <ChakraProvider>\n        <Story />\n      </ChakraProvider>]\n}"},null===(_ApiUnavailable$param2=ApiUnavailable.parameters)||void 0===_ApiUnavailable$param2||null===(_ApiUnavailable$param3=_ApiUnavailable$param2.docs)||void 0===_ApiUnavailable$param3?void 0:_ApiUnavailable$param3.source)})});var __namedExportsOrder=["HappyPath","ApiUnavailable"]}}]);